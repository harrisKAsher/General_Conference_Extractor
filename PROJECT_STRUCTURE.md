# Project Structure

## Overview

This project consists of three main Python scripts that work together to scrape General Conference talks and generate formatted PDFs.

## File Structure

```
Scripture_Extractor/
├── generate_conference_pdf.py    # Main script (combines scraping + PDF generation)
├── conference_scraper.py         # Web scraping module
├── pdf_generator.py              # PDF generation module
├── requirements.txt              # Python dependencies
├── setup.sh                      # Automated setup script
├── README.md                     # Full documentation
├── USAGE_GUIDE.md               # Quick usage guide
├── PROJECT_STRUCTURE.md         # This file
├── .gitignore                   # Git ignore rules
├── venv/                        # Virtual environment (created by setup)
└── example/
    └── 2025_April.pdf          # Example output
```

## Core Components

### 1. generate_conference_pdf.py
**Purpose:** Main entry point that orchestrates the entire process

**What it does:**
- Parses command-line arguments
- Calls the scraper to fetch conference data
- Calls the PDF generator to create the document
- Saves both JSON and PDF outputs
- Provides progress feedback

**Usage:**
```bash
python generate_conference_pdf.py <conference_url> [output_pdf]
```

### 2. conference_scraper.py
**Purpose:** Handles all web scraping functionality

**Key Classes:**
- `HTMLTextExtractor`: Parses HTML and extracts clean text
- `ConferenceScraper`: Main scraping class

**What it does:**
- Fetches conference data from Church API
- Parses HTML to extract talk links
- Downloads individual talk content
- Cleans and formats text content
- Returns structured data

**Can be used standalone:**
```bash
python conference_scraper.py <conference_url>
```

### 3. pdf_generator.py
**Purpose:** Generates formatted PDF documents

**Key Classes:**
- `ConferencePDFGenerator`: Main PDF generation class

**What it does:**
- Creates cover page with conference title
- Generates table of contents
- Formats individual talks with proper styling
- Applies professional typography
- Handles text wrapping and pagination

**Can be used standalone:**
```bash
python pdf_generator.py <json_file> <output_pdf>
```

## Data Flow

```
User Input (URL)
    ↓
generate_conference_pdf.py
    ↓
conference_scraper.py
    ↓
Church API (churchofjesuschrist.org)
    ↓
JSON Data (intermediate)
    ↓
pdf_generator.py
    ↓
PDF Output
```

## Key Features

### Web Scraping
- Uses Church's official API endpoints
- Handles URL normalization
- Extracts speaker names, titles, and content
- Cleans HTML to plain text
- Error handling for network issues

### PDF Generation
- Professional formatting with ReportLab
- Custom styles for different elements
- Cover page with conference title
- Table of contents with all talks
- Proper text justification and spacing
- Page breaks between talks

## Dependencies

### Required
- **reportlab** (4.0.0+): PDF generation library
  - Includes: pillow, charset-normalizer

### Built-in (No installation needed)
- **urllib**: HTTP requests
- **json**: JSON parsing
- **re**: Regular expressions
- **html.parser**: HTML parsing

## Configuration

### Customizable Elements

**In pdf_generator.py:**
- Font sizes and styles
- Colors (currently uses Church blue: #003366)
- Spacing and margins
- Page layout

**In conference_scraper.py:**
- API endpoints
- User agent string
- Text extraction rules
- Content filtering

## Error Handling

The scripts handle various error conditions:

1. **Network Errors**
   - Invalid URLs
   - Connection timeouts
   - 404 errors

2. **Data Errors**
   - Missing content
   - Malformed HTML
   - Empty talks

3. **File Errors**
   - Write permissions
   - Disk space
   - Invalid paths

## Testing

Test files (created during development):
- `test_scraper.py`: Tests scraping functionality
- `test_pdf.py`: Tests PDF generation with sample data
- `analyze_pdf.py`: Analyzes PDF structure

These are excluded from version control but can be recreated for testing.

## Output Files

### Generated by the script:

1. **PDF File** (e.g., `2025_April.pdf`)
   - Binary PDF document
   - Typically 300-500 KB for full conference
   - 150-200 pages

2. **JSON Data File** (e.g., `2025_April_data.json`)
   - Text file with all scraped data
   - Typically 1-2 MB
   - Useful for debugging or regenerating PDF

## Virtual Environment

The `venv/` directory contains:
- Python interpreter
- Installed packages (reportlab, etc.)
- Isolated from system Python

**Why use it:**
- Prevents conflicts with system packages
- Easy to recreate
- Portable across machines

## Setup Process

1. **setup.sh** creates virtual environment
2. Installs dependencies from **requirements.txt**
3. Verifies Python version
4. Provides usage instructions

## Maintenance

### Updating Dependencies

```bash
source venv/bin/activate
pip install --upgrade reportlab
pip freeze > requirements.txt
```

### Cleaning Up

```bash
# Remove generated files
rm *.pdf *_data.json

# Remove virtual environment
rm -rf venv/

# Recreate
./setup.sh
```

## Future Enhancements

Possible improvements:
- Add support for other languages
- Include images from talks
- Add scripture references as hyperlinks
- Generate EPUB format
- Add command-line options for styling
- Parallel downloading for faster scraping
- Progress bar with ETA

## License & Usage

This tool is for personal use. Please respect:
- Church's copyright on content
- Website terms of service
- Rate limiting (don't hammer the API)

## Support

For issues:
1. Check README.md
2. Review USAGE_GUIDE.md
3. Verify setup with `./setup.sh`
4. Test with example URL
5. Check Python version and dependencies

